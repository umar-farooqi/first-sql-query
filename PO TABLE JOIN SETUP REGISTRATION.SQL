  SELECT 
                         PO_ID,
                        MAX(CASE WHEN REG.REG_TYPE = 'COMPANY' AND REG.SR_ID = PO.COMPANY_ID THEN REG.REG_NAME END) AS COMPANY_NAME,
                        MAX(CASE WHEN (REG.REG_TYPE = 'DEALER' OR REG.REG_TYPE = 'VENDOR' OR REG.REG_TYPE = 'CUSTOMER REGISTRATION') AND REG.SR_ID = PO.VENDOR_ID THEN COALESCE(REG.PARTY_NAME, REG.REG_NAME) END) AS VENDOR_NAME,
                        MAX(CASE WHEN REG.REG_TYPE = 'AGENCY' AND REG.SR_ID = PO.AGENCY_ID THEN REG.REG_NAME || ' - ' || REG.REG_CODE END) AS AGENCY_NAME,
                        MAX(CASE WHEN REG.REG_TYPE = 'SALE POINT' AND REG.SR_ID = PO.SALE_POINT_ID THEN REG.REG_NAME END) AS SALE_POINT,
                        MAX(CASE WHEN LD.DET_ID = PO.LOADING_TYPE_ID THEN LD.LOOKUP_DET_NAME END) AS LOADING_TYPE,
                        MAX(CASE WHEN LD.DET_ID = PO.FREIGHT_TYPE_ID THEN LD.LOOKUP_DET_NAME END) AS FREIGHT_TYPE_NAME,
                        MAX(CASE WHEN LD.DET_ID = PO.PAYMENT_MODE_ID THEN LD.LOOKUP_DET_NAME END) AS PAYMENT_MODE_NAME,
                        MAX(CASE WHEN LD.DET_ID = PO.TRANSACTION_TYPE_ID THEN LD.LOOKUP_DET_NAME END) AS TRANSACTION_TYPE,
                        MAX(CASE WHEN REG.REG_TYPE = 'BANK' AND REG.SR_ID = PO.BANK_NAME_ID THEN REG.REG_NAME END) AS BANK_NAME,
                        PO.LOADING_NAME AS LOADING_POINT,
                        PO.PURCHASING_TYPE
   FROM 
                           AB_PO_PURCHASE_ORDER PO
        LEFT JOIN AB_LOOKUP_DETAIL LD ON LD.DET_ID = PO.LOADING_TYPE_ID 
                                      OR LD.DET_ID = PO.FREIGHT_TYPE_ID 
                                      OR LD.DET_ID = PO.PAYMENT_MODE_ID 
                                      OR LD.DET_ID = PO.TRANSACTION_TYPE_ID
        LEFT JOIN AB_SETUP_REGISTRATION REG ON REG.SR_ID = PO.COMPANY_ID 
                                            OR REG.SR_ID = PO.SALE_POINT_ID 
                                            OR REG.SR_ID = PO.VENDOR_ID 
                                            OR REG.SR_ID = PO.AGENCY_ID 
                                            OR REG.SR_ID = PO.BANK_NAME_ID
    GROUP BY
                PO_ID,PO.PURCHASING_TYPE,PO.LOADING_NAME
