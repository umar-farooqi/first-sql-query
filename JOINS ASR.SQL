   SETUP_REG AS(
        SELECT 
                    SO.SO_ID,
                    USER_NAME SALE_OFFER,
                    MAX(CASE WHEN ASR.SR_ID=SO.CUSTOMER_ID THEN ASR.REG_NAME END) AS PARTY_NAME,
                    MAX(CASE WHEN ASR.SR_ID=SO.FROM_WAREHOUSE_ID THEN ASR.REG_NAME END) AS FROM_WAREHOUSE,
                    MAX(CASE WHEN LD.DET_ID = SO.FREIGHT_TYPE_ID THEN LD.LOOKUP_DET_NAME END) AS FREIGHT_TYPE,
                    MAX(CASE WHEN LD.DET_ID = SO.STOCK_TYPE_ID THEN LD.LOOKUP_DET_NAME END) AS STOCK_TYPE,
                    MAX(CASE WHEN LD.DET_ID = SO.DELIVERY_STATUS THEN LD.LOOKUP_DET_NAME END) AS DELIVERY_STATUS,
                    MAX(CASE WHEN LD.DET_ID = SO.STOCK_WISE_ID THEN LD.LOOKUP_DET_NAME END) AS STOCK_WISE,
                    MAX(CASE WHEN LD.DET_ID = SO.PAYMENT_ID THEN LD.LOOKUP_DET_NAME END) AS PAYMENT_MODE
        FROM
                            AB_SO_ORDER_HEAD SO
        LEFT JOIN  AB_LOOKUP_DETAIL LD   ON (LD.DET_ID = SO.FREIGHT_TYPE_ID  OR LD.DET_ID = SO.STOCK_TYPE_ID  OR LD.DET_ID = SO.DELIVERY_STATUS  OR LD.DET_ID = SO.STOCK_WISE_ID  OR LD.DET_ID = SO.PAYMENT_ID)
        LEFT JOIN  AB_SETUP_REGISTRATION ASR ON (ASR.SR_ID=SO.FROM_WAREHOUSE_ID  OR ASR.SR_ID=SO.CUSTOMER_ID)
        LEFT JOIN  AB_UM_APPLICATION_USERS UM  ON UM.USER_ID=SO.SALE_OFFER_ID
       
        WHERE
                     -- SO.SO_TYPE = '645'
            --AND 
            SO.ORG_ID = :GV_ORG_ID
        GROUP BY
            SO.SO_ID,
            USER_NAME
 )
